<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Store the secrets locally using PersonalVault PowerShell module</title>
	
	<meta name="description" content="Store the secrets locally using PersonalVault PowerShell module.">
	
	<meta name="author" content="Harish Karthic">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="google-site-verification" content="OtiazpwYWB3A71Cr0WkitUPn7iH86UVsbq0zCDK2Aec" />

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->
	<link rel="shortcut icon" href="https://i1.wp.com/thehappymarriage.com.au/wp-content/uploads/2016/07/favicon-H-white.png?ssl=1">

	<link rel="alternate" type="application/rss+xml" title="" href="/sitemap.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/hkarthik7">
				<i class="fa fa-github"></i>
			</a>
			
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:hkarthicb@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="/assets/ico/harish-karthic.jpg" class="img-circle" />
				Harish Karthic
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="/assets/ico/harish-karthic.jpg" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">Harish Karthic</a>
    </h3>
</header>


<div id="bio" class="text-center">
	Azure DevOps Engineer and Automation Enthusiast
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/hkarthik7">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:hkarthicb@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/harish-karthic-b">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/sitemap.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Store the secrets locally using PersonalVault PowerShell module </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   October 
	   8th,
	   
	   2021
	 </span>
	  <div class="article_body">
	  <p>Managing secrets can be a hassle and especially saving the logins in excel or sticky notes for quick and easy access is vulnerable. It can be exposed anytime without our knowledge. Won’t it be good if we can have our own personal vault? A goto place to store all the credentials and access it whenever needed. Being a PowerShell lover the first thing that arouse in mind was to create a module to manage the secrets locally. Thus, <strong>PersonalVault</strong> was created.</p>

<p><strong>PersonalVault</strong> is a PowerShell module to store our credentials <strong>locally</strong> that we use regularly. It could be anything, starting from bit locker login to bank credentials all the secrets can be encrypted and stored reliably in our system. <strong>PersonalVault</strong> uses PowerShell’s inbuilt security mechanism and a 32 bit key to encrypt and store the credentials <strong>locally</strong>. We can add, update, get and delete the secrets once we’ve connected to the vault. We can export all our secrets and logins that we use for our day-to-day activities and save it to our vault on ease.</p>

<h2 id="table-of-contents">Table Of Contents</h2>

<ol>
  <li>How to get the module?</li>
  <li>Module Walk through</li>
  <li>Closing</li>
</ol>

<h3 id="how-to-get-the-module">How to get the module?</h3>

<p><strong>PersonalVault</strong> is available in <a href="https://www.powershellgallery.com/packages/PersonalVault/1.1.2">PowerShellGallery</a> for direct download or if you’re running PowerShell version 5 or higher you can run the following cmdlets to download and import it to the current working session.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Install-Module</span><span class="w"> </span><span class="nx">PersonalVault</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Import-Module</span><span class="w"> </span><span class="nx">PersonalVault</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span></code></pre></div></div>

<h3 id="module-walk-through">Module Walk through</h3>

<p>Let’s explore the cmdlets the module provides out of the box.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-Command</span><span class="w"> </span><span class="nt">-Module</span><span class="w"> </span><span class="nx">PersonalVault</span><span class="w">

</span><span class="nf">CommandType</span><span class="w">     </span><span class="nx">Name</span><span class="w">                                               </span><span class="nx">Version</span><span class="w">    </span><span class="nx">Source</span><span class="w">
</span><span class="nf">-----------</span><span class="w">     </span><span class="nf">----</span><span class="w">                                               </span><span class="nf">-------</span><span class="w">    </span><span class="nf">------</span><span class="w">
</span><span class="kr">Function</span><span class="w">        </span><span class="nf">Add-PSSecret</span><span class="w">                                       </span><span class="mf">1.1.2</span><span class="w">      </span><span class="nf">PersonalVault</span><span class="w">
</span><span class="nx">Function</span><span class="w">        </span><span class="nx">Connect-PSPersonalVault</span><span class="w">                            </span><span class="nx">1.1.2</span><span class="w">      </span><span class="nx">PersonalVault</span><span class="w">
</span><span class="kr">Function</span><span class="w">        </span><span class="nf">Get-PSArchivedKey</span><span class="w">                                  </span><span class="mf">1.1.2</span><span class="w">      </span><span class="nf">PersonalVault</span><span class="w">
</span><span class="nx">Function</span><span class="w">        </span><span class="nx">Get-PSKey</span><span class="w">                                          </span><span class="nx">1.1.2</span><span class="w">      </span><span class="nx">PersonalVault</span><span class="w">
</span><span class="kr">Function</span><span class="w">        </span><span class="nf">Get-PSSecret</span><span class="w">                                       </span><span class="mf">1.1.2</span><span class="w">      </span><span class="nf">PersonalVault</span><span class="w">
</span><span class="nx">Function</span><span class="w">        </span><span class="nx">Import-PSPersonalVault</span><span class="w">                             </span><span class="nx">1.1.2</span><span class="w">      </span><span class="nx">PersonalVault</span><span class="w">
</span><span class="kr">Function</span><span class="w">        </span><span class="nf">Register-PSPersonalVault</span><span class="w">                           </span><span class="mf">1.1.2</span><span class="w">      </span><span class="nf">PersonalVault</span><span class="w">
</span><span class="nx">Function</span><span class="w">        </span><span class="nx">Remove-PSPersonalVault</span><span class="w">                             </span><span class="nx">1.1.2</span><span class="w">      </span><span class="nx">PersonalVault</span><span class="w">
</span><span class="kr">Function</span><span class="w">        </span><span class="nf">Remove-PSPersonalVaultConnection</span><span class="w">                   </span><span class="mf">1.1.2</span><span class="w">      </span><span class="nf">PersonalVault</span><span class="w">
</span><span class="nx">Function</span><span class="w">        </span><span class="nx">Remove-PSSecret</span><span class="w">                                    </span><span class="nx">1.1.2</span><span class="w">      </span><span class="nx">PersonalVault</span><span class="w">
</span><span class="kr">Function</span><span class="w">        </span><span class="nf">Update-PSSecret</span><span class="w">                                    </span><span class="mf">1.1.2</span><span class="w">      </span><span class="nf">PersonalVault</span><span class="w">
</span></code></pre></div></div>

<p>Since we’re using the module for first time we should register our credential. Then we should use the registered credential to connect the vault each time when we access it. You can run help on each cmdlet to know the parameters and functionality that it has to provide.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Register-PSPersonalVault</span><span class="w">
</span></code></pre></div></div>

<p>When you run the above cmdlet you will get a pop-up to enter the credential and recovery word. You should remember the recovery word to get the registered credential.
Once you’ve registered, connect to the vault.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Connect-PSPersonalVault</span><span class="w">

</span><span class="nf">UserName</span><span class="w">                     </span><span class="nx">Password</span><span class="w"> </span><span class="nx">Name</span><span class="w">          </span><span class="nx">ConnectionFilePath</span><span class="w">
</span><span class="nf">--------</span><span class="w">                     </span><span class="nf">--------</span><span class="w"> </span><span class="nf">----</span><span class="w">          </span><span class="nf">------------------</span><span class="w">
</span><span class="nf">testuser</span><span class="w"> </span><span class="nx">System.Security.SecureString</span><span class="w"> </span><span class="nx">PersonalVault</span><span class="w"> </span><span class="nx">C:\Users\testuser\.cos_testuser\connection.clixml</span><span class="w">
</span></code></pre></div></div>

<p>Once you’ve successfully connected to the vault you get a connection object. The connection file path is where the registered credential are saved. You can overwrite it using <em>Force</em> parameter in <strong>Register-PSPersonalVault</strong> cmdlet. You can also remove the connection to the vault and re-register it. But to perform all these actions you should register first.</p>

<p>Now that we have connected to the vault, let’s add a secret to it.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Add-PSSecret</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"testuser@gmail.com"</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s2">"mysecretvalue"</span><span class="w"> </span><span class="nt">-Metadata</span><span class="w"> </span><span class="s2">"My gmail user account"</span><span class="w">
</span></code></pre></div></div>

<p><strong>PersonalVault</strong> validates the secret value before adding to the vault and warns if it was hacked.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Add-PSSecret</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s2">"testuser1@gmail.com"</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s2">"Password@123"</span><span class="w"> </span><span class="nt">-Metadata</span><span class="w"> </span><span class="s2">"My another gmail user account"</span><span class="w">

</span><span class="nf">WARNING:</span><span class="w"> </span><span class="nx">Secret</span><span class="w"> </span><span class="s1">'Password@123'</span><span class="w"> </span><span class="nx">was</span><span class="w"> </span><span class="nx">hacked</span><span class="w"> </span><span class="nx">2448</span><span class="w"> </span><span class="nx">time</span><span class="p">(</span><span class="nf">s</span><span class="p">);</span><span class="w"> </span><span class="nf">Consider</span><span class="w"> </span><span class="nx">changing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secret</span><span class="w"> </span><span class="nx">value.</span><span class="w">
</span></code></pre></div></div>

<p>List all the stored secrets. Optionally tab complete the names and get the secret value associated to it, either as an encrypted text or as a plain text.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSSecret</span><span class="w">

</span><span class="nf">Name</span><span class="w">                </span><span class="nx">Value</span><span class="w">
</span><span class="nf">----</span><span class="w">                </span><span class="nf">-----</span><span class="w">
</span><span class="nf">testuser1</span><span class="w">           </span><span class="nx">76492d1116743f0423413b16050a5345MgB8ADMAKwBrADcAQQA3AEMASgBzAGoAbQBmAHQANABwAHgAMAB4ADQAVQAxAHcAPQA9AHwAZA...</span><span class="w">
</span><span class="nf">testuser</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w">  </span><span class="nx">76492d1116743f0423413b16050a5345MgB8AGQAUABNAFYAYwB6AEQANABVAGoAYgBIAG8AbwBuAFIAbwBEAFMAZwBlAFEAPQA9AHwAMA...</span><span class="w">
</span><span class="nf">testuser1</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w"> </span><span class="nx">76492d1116743f0423413b16050a5345MgB8AFAAeAA2AGcAcgB2AGIAbQBJAEIAbAA3AHEARQBlAHQATwB1AHAANwBNAHcAPQA9AHwANA...</span><span class="w">

</span><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSSecret</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w">

</span><span class="nf">Name</span><span class="w">                </span><span class="nx">Value</span><span class="w">         </span><span class="nx">Metadata</span><span class="w">
</span><span class="nf">----</span><span class="w">                </span><span class="nf">-----</span><span class="w">         </span><span class="nf">--------</span><span class="w">
</span><span class="nf">testuser1</span><span class="w">           </span><span class="nx">Pass</span><span class="w">          </span><span class="nx">My</span><span class="w"> </span><span class="nx">another</span><span class="w"> </span><span class="nx">gmail</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">account</span><span class="w">
</span><span class="nf">testuser</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w">  </span><span class="nx">mysecretvalue</span><span class="w"> </span><span class="nx">My</span><span class="w"> </span><span class="nx">gmail</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">account</span><span class="w">
</span><span class="nf">testuser1</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w"> </span><span class="nx">Password</span><span class="err">@</span><span class="nx">123</span><span class="w">  </span><span class="nx">My</span><span class="w"> </span><span class="nx">another</span><span class="w"> </span><span class="nx">gmail</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">account</span><span class="w">
</span></code></pre></div></div>

<p>Get the key that is used to encrypt the credentials.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSKey</span><span class="w">
</span><span class="nf">UkbB4</span><span class="err">@</span><span class="nx">swYJx\:qKDWyTInuMEg</span><span class="err">&gt;</span><span class="nx">1o53OV</span><span class="w">
</span></code></pre></div></div>

<p>You can rotate the key using <em>Force</em> parameter and save the secrets. This way you can use new key to encrypt the secrets which provides you an additional
security. To get the secrets you have to use the right key.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Rotate the key</span><span class="w">
</span><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSKey</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="nf">?</span><span class="nx">x7GVMHZsiw:C0</span><span class="o">=</span><span class="nf">XET</span><span class="err">@</span><span class="nx">a</span><span class="p">]</span><span class="nf">eoSzuYPU3Bd</span><span class="w">

</span><span class="c"># Now list the secrets as plain text</span><span class="w">
</span><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSSecret</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w">
</span><span class="nf">WARNING:</span><span class="w"> </span><span class="nx">Cannot</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">as</span><span class="w"> </span><span class="nx">plain</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"> </span><span class="nf">Use</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">right</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secret</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">as</span><span class="w"> </span><span class="nx">plain</span><span class="w"> </span><span class="nx">text.</span><span class="w">
</span></code></pre></div></div>

<p>You can’t get the secrets because the key that was used to encrypt the secrets was different. You have use the same key to get the secrets as plain text.
Once you have rotated the key, the old key will be archived so that you can use it to get the secrets.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSArchivedKey</span><span class="w">

</span><span class="nf">DateModified</span><span class="w">          </span><span class="nx">Key</span><span class="w">
</span><span class="nf">------------</span><span class="w">          </span><span class="nf">---</span><span class="w">
</span><span class="mi">10</span><span class="nf">/08/2021</span><span class="w"> </span><span class="nx">3:55:25</span><span class="w"> </span><span class="nx">PM</span><span class="w"> </span><span class="nx">UkbB4</span><span class="err">@</span><span class="nx">swYJx\:qKDWyTInuMEg</span><span class="err">&gt;</span><span class="nx">1o53OV</span><span class="w">
</span></code></pre></div></div>

<p>Now you can use the archived key to get the secrets.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Get-PSSecret</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-Key</span><span class="w"> </span><span class="s1">'UkbB4@swYJx\:qKDWyTInuMEg&gt;1o53OV'</span><span class="w">

</span><span class="nf">Name</span><span class="w">                </span><span class="nx">Value</span><span class="w">         </span><span class="nx">Metadata</span><span class="w">
</span><span class="nf">----</span><span class="w">                </span><span class="nf">-----</span><span class="w">         </span><span class="nf">--------</span><span class="w">
</span><span class="nf">testuser1</span><span class="w">           </span><span class="nx">Pass</span><span class="w">          </span><span class="nx">My</span><span class="w"> </span><span class="nx">another</span><span class="w"> </span><span class="nx">gmail</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">account</span><span class="w">
</span><span class="nf">testuser</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w">  </span><span class="nx">mysecretvalue</span><span class="w"> </span><span class="nx">My</span><span class="w"> </span><span class="nx">gmail</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">account</span><span class="w">
</span><span class="nf">testuser1</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w"> </span><span class="nx">Password</span><span class="err">@</span><span class="nx">123</span><span class="w">  </span><span class="nx">My</span><span class="w"> </span><span class="nx">another</span><span class="w"> </span><span class="nx">gmail</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">account</span><span class="w">
</span></code></pre></div></div>

<p>Update a secret value to the existing credential set. Tab complete the name parameter and update it’s secret value easily.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Update-PSSecret</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">testuser1</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s2">"Thisisunhackablepassword"</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span></code></pre></div></div>

<p>Remove the secret from the vault using it’s Name.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Remove-PSSecret</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">testuser1</span><span class="err">@</span><span class="nx">gmail.com</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span></code></pre></div></div>

<p>Import the registered credential using the recovery word.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PS</span><span class="w"> </span><span class="nx">C:\</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Import-PSPersonalVault</span><span class="w">

</span><span class="nf">cmdlet</span><span class="w"> </span><span class="nx">Import-PSPersonalVault</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="nx">pipeline</span><span class="w"> </span><span class="nx">position</span><span class="w"> </span><span class="nx">1</span><span class="w">
</span><span class="nf">Supply</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">parameters:</span><span class="w">
</span><span class="nf">RecoveryWord:</span><span class="w"> </span><span class="o">*****</span><span class="w">

</span><span class="nf">UserName</span><span class="w">    </span><span class="nx">Password</span><span class="w">
</span><span class="nf">--------</span><span class="w">    </span><span class="nf">--------</span><span class="w">
</span><span class="nf">testuser</span><span class="w"> </span><span class="nx">Testuser</span><span class="w">
</span></code></pre></div></div>

<p>Explore the cmdlets and store the secrets locally &amp; securely. Note that PowerShell uses Windows data protection API to encrypt the credentials. This means that only the user who saves the credential in the same machine can decrypt it.</p>

<h3 id="closing">Closing</h3>

<p>Microsoft has officially released <a href="https://devblogs.microsoft.com/powershell/secretmanagement-and-secretstore-are-generally-available/">SecretsManagement</a> PowerShell module to register and manage the secrets locally and remotely. This provides additional features and flexibility of using any secrets management providers. <strong>PersonalVault</strong> is not a replacement module or similar to <strong>SecretsManagement</strong>, it is a simple module which takes the advantage of PowerShell’s inbuilt security to store the credential locally and securely. Having that said, for any module related issues, improvements and feedback open a PR in <a href="https://github.com/hkarthik7/PersonalVault">github</a>.
Happy coding.</p>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#PowerShell-ref">
					PowerShell <span>(4)</span>
					
				</a></li>
			
		  
		</ul>
		  

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#Personal Vault-ref">
					Personal Vault <span>(1)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#PowerShell-ref">
					PowerShell <span>(6)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#Local Key Vault-ref">
					Local Key Vault <span>(1)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#Secrets Manager-ref">
					Secrets Manager <span>(1)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Store the secrets locally using PersonalVault PowerShell module"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <!-- <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a> -->
      </section>

      <section class="col-sm-6 author">
        <!-- <img src="/assets/ico/harish-karthic.jpg" class="img-rounded author-image" /> -->
        <h4 class="section-title author-name">Harish Karthic</h4>
        <p class="author-bio">Azure DevOps Engineer and Automation Enthusiast</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/azure%20devops/powershell/azure/2021/01/16/Parse-http-logs-of-Azure-webapp-using-Azure-DevOps-CI-pipeline.html" title="Create a CI pipeline to parse http logs of Azure app service">&larr; Previous</a></li>
		  
		  
			<li class="next disabled"><a>Next &rarr;</a>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>





		<footer>
			<hr/>
			<!-- <p class="text-muted" style="padding-left: 600px;">
				&copy; 2021 Harish Karthic
			</p>
			<span class="text-muted" style="padding-left: 600px;">Theme by debyll - Jekyll</span> -->
			<p class="text-muted">
				&copy; 2021 Harish Karthic
			</p>
			<span class="text-muted">Theme by debyll - Jekyll</span>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



